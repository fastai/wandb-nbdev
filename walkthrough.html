<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Catalog and version models, track metadata and lineage, promote the best models to production, and report on evaluation analytics.">

<title>Weights &amp; Biases - Model Management Walkthrough</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./init.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Weights &amp; Biases - Model Management Walkthrough">
<meta property="og:description" content="Catalog and version models, track metadata and lineage, promote the best models to production, and report on evaluation analytics.">
<meta property="og:site-name" content="Weights &amp; Biases">
<meta name="twitter:title" content="Weights &amp; Biases - Model Management Walkthrough">
<meta name="twitter:description" content="Catalog and version models, track metadata and lineage, promote the best models to production, and report on evaluation analytics.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Weights &amp; Biases</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/fastai/wandb-nbdev"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Model Management Walkthrough</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Guides</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">Getting Started</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./init.html" class="sidebar-item-text sidebar-link">Launch Experiments with wandb.init</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./walkthrough.html" class="sidebar-item-text sidebar-link active">Model Management Walkthrough</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#create-a-new-registered-model" id="toc-create-a-new-registered-model" class="nav-link active" data-scroll-target="#create-a-new-registered-model">1. Create a new Registered Model</a></li>
  <li><a href="#train-log-model-versions" id="toc-train-log-model-versions" class="nav-link" data-scroll-target="#train-log-model-versions">2. Train &amp; log Model Versions</a></li>
  <li><a href="#link-model-versions-to-the-registered-model" id="toc-link-model-versions-to-the-registered-model" class="nav-link" data-scroll-target="#link-model-versions-to-the-registered-model">3. Link Model Versions to the Registered Model</a></li>
  <li><a href="#use-a-model-version" id="toc-use-a-model-version" class="nav-link" data-scroll-target="#use-a-model-version">4. Use a Model Version</a></li>
  <li><a href="#evaluate-model-performance" id="toc-evaluate-model-performance" class="nav-link" data-scroll-target="#evaluate-model-performance">5. Evaluate Model Performance</a></li>
  <li><a href="#promote-a-version-to-production" id="toc-promote-a-version-to-production" class="nav-link" data-scroll-target="#promote-a-version-to-production">6. Promote a Version to Production</a></li>
  <li><a href="#consume-the-production-model" id="toc-consume-the-production-model" class="nav-link" data-scroll-target="#consume-the-production-model">7. Consume the Production Model</a></li>
  <li><a href="#build-a-reporting-dashboard" id="toc-build-a-reporting-dashboard" class="nav-link" data-scroll-target="#build-a-reporting-dashboard">8. Build a Reporting Dashboard</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Model Management Walkthrough</h1>
</div>

<div>
  <div class="description">
    Catalog and version models, track metadata and lineage, promote the best models to production, and report on evaluation analytics.
  </div>
</div>


<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2FhrEhWp8yIK7bNMjvWioX%2FScreen%20Shot%202022-06-21%20at%2010.22.27%20AM.png?alt=media&amp;token=255db898-d67d-4c8c-8fb8-e59e4781b098" class="img-fluid"></p>
<p>In this walkthrough you’ll learn how to use Weights &amp; Biases for Model Management. Track, visualize, and report on the complete production model workflow.</p>
<ol type="1">
<li><strong>Model Versioning</strong>: Save and restore every version of your model &amp; learned parameters - organize versions by use case and objective. Track training metrics, assign custom metadata, and document rich markdown descriptions of your models.</li>
<li><strong>Model Lineage:</strong> Track the exact code, hyperparameters, &amp; training dataset used to produce the model. Enable model reproducibility.</li>
<li><strong>Model Lifecycle:</strong> Promote promising models to positions like “staging” or “production” - allowing downstream users to fetch the best model automatically. Communicate progress collaboratively in Reports.</li>
</ol>
<p><em>We are actively building new Model Management features. Please reach out with questions or suggestions at support@wandb.com.</em></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Please see the <a href="https://docs.wandb.ai/ref/app/pages/project-page#artifacts-tab">Artifact Tab</a> details for a discussion of all content available in the Model Registry!</p>
</div>
</div>
<p>Now we will walk through a canonical workflow for producing, organizing, and consuming trained models:</p>
<ol type="1">
<li><a href="https://docs.wandb.ai/guides/models/walkthrough#1.-create-a-new-model-portfolio">Create a new Registered Model</a></li>
<li><a href="https://docs.wandb.ai/guides/models/walkthrough#2.-train-and-log-model-versions">Train &amp; log Model Versions</a></li>
<li><a href="https://docs.wandb.ai/guides/models/walkthrough#3.-link-model-versions-to-the-portfolio">Link Model Versions to the Registered Model</a></li>
<li><a href="https://docs.wandb.ai/guides/models/walkthrough#4.-use-a-model-version">Using a Model Version</a></li>
<li><a href="https://docs.wandb.ai/guides/models/walkthrough#5.-evaluate-model-performance">Evaluate Model Performance</a></li>
<li><a href="https://docs.wandb.ai/guides/models/walkthrough#6.-promote-a-version-to-production">Promote a Version to Production</a></li>
<li><a href="https://docs.wandb.ai/guides/models/walkthrough#7.-consume-the-production-model">Use the Production Model for Inference</a></li>
<li><a href="https://docs.wandb.ai/guides/models/walkthrough#8.-build-a-reporting-dashboard">Build a Reporting Dashboard</a></li>
</ol>
<p><strong>A</strong> <a href="https://colab.research.google.com/drive/1wjgr9AHICOa3EM1Ikr_Ps_MAm5D7QnCC"><strong>companion colab notebook</strong></a> <strong>is provided which covers step 2-3 in the first code block and steps 4-6 in the second code block.</strong></p>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2FNkDrBn4Dyl7OGjekeADh%2FScreen%20Shot%202022-06-21%20at%2010.24.10%20AM.png?alt=media&amp;token=1b4342a6-5f85-4e12-a6a8-0bf1d8f9fb9d" class="img-fluid"></p>
<section id="create-a-new-registered-model" class="level2">
<h2 class="anchored" data-anchor-id="create-a-new-registered-model">1. Create a new Registered Model</h2>
<p>First, create a Registered Model to hold all the candidate models for your particular modeling task. In this tutorial, we will use the classic <a href="https://pytorch.org/vision/stable/generated/torchvision.datasets.MNIST.html#torchvision.datasets.MNIST">MNIST Dataset</a> - 28x28 grayscale input images with output classes from 0-9. The video below demonstrates how to create a new Registered Model.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Using Model Registry</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Using Artifact Browser</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ol type="1">
<li>Visit your Model Registry at <a href="https://wandb.ai/registry/model">wandb.ai/registry/model</a> (linked from homepage).</li>
</ol>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2Fb2CkO93ZQtcAAB6F4CrJ%2FScreen%20Shot%202022-06-21%20at%2010.14.10%20AM.png?alt=media&amp;token=8c18f6ac-b606-43c5-8bae-d0b632061765" class="img-fluid"></p>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2F9AS8BRreKgHeEZ3axDCe%2FScreen%20Shot%202022-06-21%20at%2010.18.28%20AM.png?alt=media&amp;token=04586044-40ac-441c-8ebd-45eea5277cac" class="img-fluid"></p>
<ol start="2" type="1">
<li>Click the <code>Create Registered Model</code> button at the top of the Model Registry.</li>
</ol>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2FseDobiyiAniuIA4bxUSn%2FScreen%20Shot%202022-06-21%20at%2010.17.24%20AM.png?alt=media&amp;token=1e28c8f6-b389-468d-91e3-4fdb8aaaab46" class="img-fluid"></p>
<ol start="3" type="1">
<li>Make sure the <code>Owning Entity</code> and <code>Owning Project</code> are set correctly to the values you desire. Enter a unique name for your new Registered Model that describes the modeling task or use-case of interest.</li>
</ol>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2FE8H3r7lvIOAWohdP56mb%2FScreen%20Shot%202022-06-21%20at%2010.20.23%20AM.png?alt=media&amp;token=f4aa72dc-fa7d-4bba-90a6-c8cfbc5e41c5" class="img-fluid"></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ol type="1">
<li>Visit your Project’s Artifact Browser: <code>wandb.ai/&lt;entity&gt;/&lt;project&gt;/artifacts</code></li>
<li>Click the <code>+</code> icon on the bottom of the Artifact Browser Sidebar</li>
<li>Select <code>Type: model</code>, <code>Style: Collection</code>, and enter a name. In our case <code>MNIST Grayscale 28x28</code>. Remember, a Collection should map to a modeling task - enter a unique name that describes the use case.</li>
</ol>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2F1HUyeXPDq1esREYGdN7T%2F2022-05-17%2014.20.36.gif?alt=media&amp;token=689ca931-b834-447b-875f-3e8631e3ff35" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="train-log-model-versions" class="level2">
<h2 class="anchored" data-anchor-id="train-log-model-versions">2. Train &amp; log Model Versions</h2>
<p>Next, you will log a model from your training script:</p>
<ol type="1">
<li><p>(Optional) Declare your dataset as a dependency so that it is tracked for reproducibility and audibility</p></li>
<li><p><strong>Serialize</strong> your model to disk periodically (and/or at the end of training) using the serialization process provided by your modeling library (eg <a href="https://pytorch.org/tutorials/beginner/saving_loading_models.html">PyTorch</a> &amp; <a href="https://www.tensorflow.org/guide/keras/save_and_serialize">Keras</a>).</p></li>
<li><p><strong>Add</strong> your model files to an Artifact of type “model”</p>
<ul>
<li>Note: We use the name <code>f'mnist-nn-{wandb.run.id}'</code>. While not required, it is advisable to name-space your “draft” Artifacts with the Run id in order to stay organized</li>
</ul></li>
<li><p>(Optional) Log training metrics associated with the performance of your model during training.</p>
<ul>
<li>Note: The data logged immediately before logging your Model Version will automatically be associated with that version</li>
</ul></li>
<li><p><strong>Log</strong> your model</p>
<ul>
<li>Note: If you are logging multiple versions, it is advisable to add an alias of “best” to your Model Version when it outperforms the prior versions. This will make it easy to find the model with peak performance - especially when the tail end of training may overfit!</li>
</ul></li>
</ol>
<p>By default, you should use the native W&amp;B Artifacts API to log your serialized model. However, since this pattern is so common, we have provided a single method which combines serialization, Artifact creation, and logging. See the “(Beta) Using <code>log_model</code>” tab for details.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Using Artifacts</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">(Beta) Using <code>log_model</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Declare Dataset Dependency</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> wandb</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Always initialize a W&amp;B run to start tracking</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>wandb.init()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># (Optional) Declare an upstream dataset dependency</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># see the `Declare Dataset Dependency` tab for</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># alternative examples.</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> wandb.use_artifact(<span class="st">"mnist:latest"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># At the end of every epoch (or at the end of your script)...</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ... Serialize your model</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>model.save(<span class="st">"path/to/model.pt"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ... Create a Model Version</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>art <span class="op">=</span> wandb.Artifact(<span class="ss">f'mnist-nn-</span><span class="sc">{</span>wandb<span class="sc">.</span>run<span class="sc">.</span><span class="bu">id</span><span class="sc">}</span><span class="ss">'</span>, <span class="bu">type</span><span class="op">=</span><span class="st">"model"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ... Add the serialized files</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>art.add_file(<span class="st">"path/to/model.pt"</span>, <span class="st">"model.pt"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># (optional) Log training metrics</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>wandb.log({<span class="st">"train_loss"</span>: <span class="fl">0.345</span>, <span class="st">"val_loss"</span>: <span class="fl">0.456</span>})</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ... Log the Version</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> model_is_best:</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the model is the best model so far, add "best" to the aliases</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    wandb.log_artifact(art, aliases<span class="op">=</span>[<span class="st">"latest"</span>, <span class="st">"best"</span>])</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    wandb.log_artifact(art)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following code snippet leverages actively developed <code>beta</code> APIs and therefore is subject to change and not guaranteed to be backwards compatible.</p>
</div>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wandb.beta.workflows <span class="im">import</span> log_model</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (Optional) Declare an upstream dataset dependency</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># see the `Declare Dataset Dependency` tab for</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># alternative examples.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> wandb.use_artifact(<span class="st">"mnist:latest"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (optional) Log training metrics</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>wandb.log({<span class="st">"train_loss"</span>: <span class="fl">0.345</span>, <span class="st">"val_loss"</span>: <span class="fl">0.456</span>})</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># This one method will serialize the model, start a run, create a version</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># add the files to the version, and log the version. You can override</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># the default name, project, aliases, metadata, and more!</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>log_model(model, <span class="st">"mnist-nn"</span>, aliases<span class="op">=</span>[<span class="st">"best"</span>] <span class="cf">if</span> model_is_best <span class="cf">else</span> [])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note: you may want to define custom serialization and deserialization strategies. You can do so by subclassing the <a href="https://github.com/wandb/wandb/blob/9dfa60b14599f2716ab94dd85aa0c1113cb5d073/wandb/sdk/data_types/saved_model.py#L73"><code>_SavedModel</code> class</a>, similar to the <a href="https://github.com/wandb/wandb/blob/9dfa60b14599f2716ab94dd85aa0c1113cb5d073/wandb/sdk/data_types/saved_model.py#L358"><code>_PytorchSavedModel</code> class</a>. All subclasses will automatically be loaded into the serialization registry. <em>As this is a beta feature, please reach out to support@wandb.com with questions or comments.</em></p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>If you would like to track your training data, you can declare a dependency by calling <code>wandb.use_artifact</code> on your dataset. Here are 3 examples of how you can declare a dataset dependency:</p>
<p><strong>Dataset stored in W&amp;B</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> wandb.use_artifact(<span class="st">"[[entity/]project/]name:alias"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Dataset stored on Local Filesystem</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>art <span class="op">=</span> wandb.Artifact(<span class="st">"dataset_name"</span>, <span class="st">"dataset"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>art.add_dir(<span class="st">"path/to/data"</span>) <span class="co"># or art.add_file("path/to/data.csv")</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> wandb.use_artifact(art)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Dataset stored on Remote Bucket</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>art <span class="op">=</span> wandb.Artifact(<span class="st">"dataset_name"</span>, <span class="st">"dataset"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>art.add_reference(<span class="st">"s3://path/to/data"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> wandb.use_artifact(art)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>After logging 1 or more Model Versions, you will notice that your will have a new Model Artifact in your Artifact Browser. Here, we can see the results of logging 5 versions to an artifact named <code>mnist_nn-1r9jjogr</code>.</p>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2FW95CUXm3wFWmShgriUus%2FScreen%20Shot%202022-06-21%20at%2010.25.13%20AM.png?alt=media&amp;token=896e1dad-9a32-46c4-81d4-df61e641b740" class="img-fluid"></p>
<p>If you are following along the example notebook, you should see a Run Workspace with charts similar to the image below</p>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2FHy8efgajVKuaTgOHy7db%2FScreen%20Shot%202022-05-12%20at%2011.42.12%20AM.png?alt=media&amp;token=4508d5ee-c900-46b3-a332-acb6e0ad7994" class="img-fluid"></p>
</section>
<section id="link-model-versions-to-the-registered-model" class="level2">
<h2 class="anchored" data-anchor-id="link-model-versions-to-the-registered-model">3. Link Model Versions to the Registered Model</h2>
<p>Now, let’s say that we are ready to link one of our Model Versions to the Registered Model. We can accomplish this manually as well as via an API.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Manual Linking</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Programatic Linking</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">(Beta) Using <code>link_model</code></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>The following video below demonstrates how to manually link a Model Version to your newly created Registered Model:</p>
<ol type="1">
<li>Navigate to the Model Version of interest</li>
<li>Click the link icon</li>
<li>Select the target Registered Model</li>
<li>(optional): Add additional aliases</li>
</ol>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2FpKissGM67eXf771EoUQq%2F2022-05-11%2015.13.48.gif?alt=media&amp;token=923c6514-6c22-4c0d-a8d4-2ed7edcf51e7" class="img-fluid"></p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>While manual linking is useful for one-off Models, it is often useful to programmatically link Model Versions to a Collection - consider a nightly job or CI pipeline that wants to link the best Model Version from every training job. Depending on your context and use case, you may use one of 3 different linking APIs:</p>
<p><strong>Fetch Model Artifact from Public API:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> wandb</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetch the Model Version via API</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>art <span class="op">=</span> wandb.Api().artifact(...)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Link the Model Version to the Model Collection</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>art.link(<span class="st">"[[entity/]project/]collectionName"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Model Artifact is “used” by the current Run:</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> wandb</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a W&amp;B run to start tracking</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>wandb.init()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain a reference to a Model Version</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>art <span class="op">=</span> wandb.use_artifact(...)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Link the Model Version to the Model Collection</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>art.link(<span class="st">"[[entity/]project/]collectionName"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Model Artifact is logged by the current Run:</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> wandb</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a W&amp;B run to start tracking</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>wandb.init()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Model Version</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>art <span class="op">=</span> wandb.Artifact(...)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Log the Model Version</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>wandb.log_artifact(art)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Link the Model Version to the Collection</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>wandb.run.link_artifact(art, <span class="st">"[[entity/]project/]collectionName"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>The following code snippet leverages actively developed <code>beta</code> APIs and therefore is subject to change and not guaranteed to be backwards compatible.</p>
<p>In the case that you logged a model with the beta <code>log_model</code> discussed above, then you can use it’s companion method: <code>link_model</code></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wandb.beta.workflows <span class="im">import</span> log_model, link_model</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain a Model Version</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>model_version <span class="op">=</span> wb.log_model(model, <span class="st">"mnist_nn"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Link the Model Version</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>link_model(model_version, <span class="st">"[[entity/]project/]collectionName"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After you link the Model Version, you will see hyperlinks connecting the Version in the Registered Model to the source Artifact and visa versa.</p>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2Fo19AA9cXsA0ZMslGkb89%2F13_edit.png?alt=media&amp;token=4feb1cd8-5ba2-444f-9a0f-0c93a7228cd8" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="use-a-model-version" class="level2">
<h2 class="anchored" data-anchor-id="use-a-model-version">4. Use a Model Version</h2>
<p>Now we are ready to consume a Model - perhaps to evaluate its performance, make predictions against a dataset, or use in a live production context. Similar to logging a Model, you may choose to use the raw Artifact API or the more opinionated beta APIs.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Using Artifacts</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">(Beta) Using <code>use_model</code></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>You can load in a Model Version using the <code>use_artifact</code> method.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> wandb</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Always initialize a W&amp;B run to start tracking</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>wandb.init()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Download your Model Version files</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> wandb.use_artifact(<span class="st">"[[entity/]project/]collectionName:latest"</span>).download()</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Deserialize your model (this will be your custom code to load in</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># a model from disk - reversing the serialization process used in step 2)</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> make_model_from_data(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following code snippet leverages actively developed <code>beta</code> APIs and therefore is subject to change and not guaranteed to be backwards compatible.</p>
</div>
</div>
<p>Directly manipulating model files and handling deserialization can be tricky - especially if you were not the one who serialized the model. As a companion to <code>log_model</code>, <code>use_model</code> automatically deserializes and reconstructs your model for use.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wandb.beta.workflows <span class="im">import</span> use_model</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> use_model(<span class="st">"[[entity/]project/]collectionName"</span>).model_obj()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="evaluate-model-performance" class="level2">
<h2 class="anchored" data-anchor-id="evaluate-model-performance">5. Evaluate Model Performance</h2>
<p>After training many Models, you will likely want to evaluate the performance of those models. In most circumstances you will have some held-out data which serves as a test dataset, independent of the dataset your models have access to during training. To evaluate a Model Version, you will want to first complete step 4 above to load a model into memory. Then:</p>
<ol type="1">
<li>(Optional) Declare a data dependency to your evaluation data</li>
<li><strong>Log</strong> metrics, media, tables, and anything else useful for evaluation</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ... continuation from 4</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (Optional) Declare an upstream evaluation dataset dependency</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> wandb.use_artifact(<span class="st">"mnist-evaluation:latest"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate your model in whatever way makes sense for your</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>loss, accuracy, predictions <span class="op">=</span> evaluate_model(model, dataset)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Log out metrics, images, tables, or any data useful for evaluation.</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>wandb.log({<span class="st">"loss"</span>: loss, <span class="st">"accuracy"</span>: accuracy, <span class="st">"predictions"</span>: predictions})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you are executing similar code, as demonstrated in the notebook, you should see a workspace similar to the image below - here we even show model predictions against the test data!</p>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2FJd1Ztg57guvPGFD06mbM%2FScreen%20Shot%202022-05-12%20at%2011.45.09%20AM.png?alt=media&amp;token=d10a7066-7d77-4863-aea0-634485f40cef" class="img-fluid"></p>
</section>
<section id="promote-a-version-to-production" class="level2">
<h2 class="anchored" data-anchor-id="promote-a-version-to-production">6. Promote a Version to Production</h2>
<p>Next, you will likely want to denote which version in the Registered Model is intended to be used for Production. Here, we use the concept of aliases. Each Registered Model can have any aliases which make sense for your use case - however we often see <code>production</code> as the most common alias. Each alias can only be assigned to a single Version at a time.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">via UI Interface</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">via API</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2F6g0FZl6bbOt9cYRKAMRX%2FScreen%20Shot%202022-06-06%20at%207.50.27%20AM.png?alt=media&amp;token=e73a4446-e6a6-460e-8e04-99e1f3c5906e" class="img-fluid"></p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Follow steps in <a href="https://docs.wandb.ai/guides/models/walkthrough#3.-linking-model-versions-to-the-portfolio">Part 3. Link Model Versions to the Collection</a> and add the aliases you want to the <code>aliases</code> parameter.</p>
<p>The image below shows the new <code>production</code> alias added to v1 of the Registered Model!</p>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2FCYJr0uUQV71NOvvtvvpJ%2FScreen%20Shot%202022-05-12%20at%2011.46.43%20AM.png?alt=media&amp;token=23767732-6788-4373-b0c6-0d7db2519f82" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="consume-the-production-model" class="level2">
<h2 class="anchored" data-anchor-id="consume-the-production-model">7. Consume the Production Model</h2>
<p>Finally, you will likely want to use your production Model for inference. To do so, simply follow the steps outlined in <a href="https://docs.wandb.ai/guides/models/walkthrough#4.-evaluate-model-performance">Part 4. Using a Model Version</a>, with the <code>production</code> alias. For example:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>wandb.use_artifact(<span class="st">"[[entity/]project/]registeredModelName:production"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can reference a Version within the Registered Model using different alias strategies:</p>
<ul>
<li><code>latest</code> - which will fetch the most recently linked Version</li>
<li><code>v#</code> - using <code>v0</code>, <code>v1</code>, <code>v2</code>, … you can fetch a specific version in the Registered Model</li>
<li><code>production</code> - you can use any custom alias that you and your team have assigned</li>
</ul>
</section>
<section id="build-a-reporting-dashboard" class="level2">
<h2 class="anchored" data-anchor-id="build-a-reporting-dashboard">8. Build a Reporting Dashboard</h2>
<p>Using Weave Panels, you can display any of the Model Registry/Artifact views inside of Reports! See a <a href="https://wandb.ai/timssweeney/model_management_docs_official_v0/reports/MNIST-Grayscale-28x28-Model-Dashboard--VmlldzoyMDI0Mzc1">demo here</a>. Below is a full-page screenshot of an example Model Dashboard.</p>
<p><img src="https://1039519455-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-Lqya5RvLedGEWPhtkjU-1972196547%2Fuploads%2FagKefedLijcKacK3wUEb%2FScreenshot%202022-06-21%20at%2010-42-44%20Weights%20%26%20Biases.png?alt=media&amp;token=a72df30a-46a2-4ea9-8acd-ab7914a17002" class="img-fluid"></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./init.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Launch Experiments with wandb.init</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>